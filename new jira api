let
    // === CONFIGURATION ===
    JiraDomain = "wsib.atlassian.net",
    Email = "your_email@example.com",
    ApiToken = "your_api_token_here",
    JqlQuery = "filter=11824",        // your filter or JQL
    MaxResults = 100,                 // Jira max per page

    // Encode auth (email:token â†’ base64)
    AuthKey = Binary.ToText(Text.ToBinary(Email & ":" & ApiToken), BinaryEncoding.Base64),

    // Function to fetch a page from Jira
    GetPage = (StartAt as number) =>
        let
            RequestBody = Json.FromValue([
                query = JqlQuery,
                startAt = StartAt,
                maxResults = MaxResults,
                fields = {"summary","priority","assignee","status","issuetype","fixVersions","created","customfield_10020"}
            ]),
            Response = Json.Document(
                Web.Contents(
                    "https://" & JiraDomain & "/rest/api/3/search/jql",
                    [
                        Headers = [
                            #"Authorization" = "Basic " & AuthKey,
                            #"Content-Type" = "application/json"
                        ],
                        Content = Text.ToBinary(Json.ToText(RequestBody))
                    ]
                )
            )
        in
            Response,

    // Generate pages until no more issues
    Pages = List.Generate(
        () => [StartAt = 0, Response = GetPage(0)],
        each List.Count([Response][issues]) > 0,
        each [StartAt = [StartAt] + MaxResults, Response = GetPage([StartAt])],
        each [Response][issues]
    ),

    // Combine all issues into one list
    CombinedData = List.Combine(Pages),

    // Convert to table and expand fields
    #"Converted to Table" = Table.FromList(CombinedData, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #"Expanded Issue" = Table.ExpandRecordColumn(#"Converted to Table", "Column1", {"key","fields"}, {"Jira Id","Fields"}),

    // Expand nested fields
    #"Expanded Fields" = Table.ExpandRecordColumn(#"Expanded Issue", "Fields", {"summary","priority","assignee","status","issuetype","fixVersions","created","customfield_10020"}, {"Summary","Priority","Assignee","Status","IssueType","FixVersions","CreatedDate","Sprint"}),
    #"Expanded Priority" = Table.ExpandRecordColumn(#"Expanded Fields", "Priority", {"name"}, {"Priority"}),
    #"Expanded Assignee" = Table.ExpandRecordColumn(#"Expanded Priority", "Assignee", {"displayName"}, {"Assignee"}),
    #"Expanded Status" = Table.ExpandRecordColumn(#"Expanded Assignee", "Status", {"name"}, {"Status"}),
    #"Expanded IssueType" = Table.ExpandRecordColumn(#"Expanded Status", "IssueType", {"name"}, {"Issue Type"}),
    #"Expanded FixVersions" = Table.ExpandListColumn(#"Expanded IssueType", "FixVersions"),
    #"Expanded FixVersions2" = Table.ExpandRecordColumn(#"Expanded FixVersions", "FixVersions", {"name"}, {"Release Date"}),
    #"Expanded Sprint" = Table.ExpandListColumn(#"Expanded FixVersions2", "Sprint"),
    #"Expanded Sprint2" = Table.ExpandRecordColumn(#"Expanded Sprint", "Sprint", {"name"}, {"Sprint"}),

    // Group Sprint values if multiple per issue
    #"Grouped Rows" = Table.Group(#"Expanded Sprint2", {"Jira Id", "Issue Type", "Summary", "Priority", "Status", "Release Date", "Assignee", "CreatedDate"}, {
        {"Sprint", each Text.Combine(List.Transform([Sprint], Text.From), ", "), type text}
    })
in
    #"Grouped Rows"
